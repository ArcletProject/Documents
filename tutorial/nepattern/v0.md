# NEPattern

[`NEPattern`](https://github.com/ArcletProject/NEPattern) 是 `Arclet Project` 下的负责类型转换、类型验证的模块, 也是 `Arclet` 的核心模块之一.

`NEPattern` 旨在提供一种简单的方式, 使得开发者可以在不了解正则表达式的情况下, 也能够轻松地进行类型转换与类型验证.

- 通过传入的 `converter` 和 `validator` 等实现了高效的类型转化与类型验证功能
- 提供了多种预置的实例, 例如常见的 `INT` `FLOAT` `BOOL` 等
- 提供了良好的 `typing` 支持, 使得开发者可以传入大多数 `typing` 模块中的类型:

```python
from nepattern import type_parser
from typing import List

pat = type_parser(List[int])
assert pat.validate([1, 2, 3]).success
```
- 
- `NEPattern` 引入了 `Patterns` 与 `create_local_patterns` 等函数, 使得开发者可以自由的控制当前环境下的 `Pattern` 实例


```python
from nepattern import BasePattern

pat = BasePattern.of(int)
assert pat.validate(13).success
assert not 13.0 >> pat
```

## 安装

:::code-group
```bash [pdm]
pdm add "nepattern<1.0"
```

```bash [poetry]
poetry add "nepattern<1.0"
```

```bash [pip]
pip install --upgrade "nepattern<1.0"
```

:::

## 构造

一般而言，我们通过 `nepattern.BasePattern` 来构造一个 `NEPattern` 实例。

```python
from nepattern import BasePattern, MatchMode

pat = BasePattern(mode=MatchMode.TYPE_CONVERT, origin=int, accept=str, convert=lambda _, x: int(x))

assert pat.validate("42").success
```

可以发现，我们通过 `BasePattern` 的 `mode` 参数来指定匹配模式。事实上，这里有五种匹配模式：

- `KEEP`：保持原样，不进行任何转换
- `REGEX_MATCH`：使用正则表达式进行匹配
- `REGEX_CONVERT`：使用正则表达式匹配并进行转换
- `TYPE_CONVERT`：传入值直接进行转换
- `VALUE_OPERATE`：传入值进行操作

对于每种模型，`BasePattern` 的构造参数会有所不同：

:::code-group
```python [KEEP]
BasePattern(
    origin,  # 目标类型
    alias,   # 别名
    accepts,  # 接受的类型
    addition_accepts,  # 以其他 BasePattern 作为接受类型
    previous,  # 类型不匹配时的前置处理
    validators,  # 验证方法
)
```

```python [REGEX_MATCH]
BasePattern(
    pattern,  # 正则表达式
    alias,  # 别名
    previous,  # 类型不匹配时的前置处理
    validators,  # 验证方法
)
```

```python [REGEX_MATCH]
BasePattern(
    pattern,  # 正则表达式
    origin,  # 目标类型
    alias,  # 别名
    converter,  # 转换方法
    previous,  # 类型不匹配时的前置处理
    validators,  # 验证方法
)
```

```python [TYPE_CONVERT]
BasePattern(
    origin,  # 目标类型
    alias,  # 别名
    converter,  # 转换方法
    accepts,   # 接受的类型
    addition_accepts,  # 以其他 BasePattern 作为接受类型
    previous,  # 类型不匹配时的前置处理
    validators,  # 验证方法
)
```

```python [VALUE_OPERATE]
BasePattern(
    origin,  # 目标类型
    alias,  # 别名
    converter,  # 转换方法
    previous,  # 类型不匹配时的前置处理
    validators,  # 验证方法
)
```
